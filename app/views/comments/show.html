<script>
  const currentUserQuery = ['id', 'name']
  const commentQuery = {
    id: true,
    body: true,
    postId: true,
    reactionSummary: true,
    user: ['id', 'name'],
    myReaction: 'kind'
  }
  const currentUserModel = new ArSyncModel({ api: 'profile', query: currentUserQuery })
  const commentModel = new ArSyncModel({
    api: 'comment',
    params: { id: location.pathname.match(/\d+/)[0] },
    query: commentQuery
  })
  ArSyncModel.waitForLoad(currentUserModel, commentModel).then(() => {
    new Vue({ el: '#syncbody', data: { currentUser: currentUserModel.data, comment: commentModel.data } })
  })
</script>
<div id='syncbody' v-cloak>
  <a :href="'/posts/' + comment.postId">
    <i class='material-icons'>reply</i>
    Back
  </a>
  <div>
    <b><a :href="'/users/' + comment.user.id">{{ comment.user.name }}</a>:</b>
    <span>{{ comment.body }}</span>
    &nbsp;
    <a :href="'/comments/' + comment.id + '/edit'" v-if='comment.user.id == currentUser.id'>
      <i class='material-icons'>edit</i>
    </a>
  </div>
  <reactions :url="'/comments/' + comment.id + '/reaction'" :summary='comment.reactionSummary' :mine='comment.myReaction'></reactions>
  <hr>
</div>
